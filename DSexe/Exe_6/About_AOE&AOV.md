# 🕸️ 图论核心应用：AOV 网与 AOE 网详解

> **前言**：在工程管理、流程控制和计算机科学中，**有向无环图 (DAG, Directed Acyclic Graph)** 是解决“顺序”与“时间”问题的核心模型。根据顶点和边所代表含义的不同，DAG 衍生出了两种重要的网络模型：**AOV 网** 和 **AOE 网**。

---

## 📚 目录

1.  [AOV 网 (Activity On Vertex)](#1-aov-网-activity-on-vertex)
    * [核心定义](#11-核心定义)
    * [拓扑排序 (Topological Sort)](#12-拓扑排序-topological-sort)
2.  [AOE 网 (Activity On Edge)](#2-aoe-网-activity-on-edge)
    * [核心定义](#21-核心定义)
    * [关键路径 (Critical Path)](#22-关键路径-critical-path)
    * [四大核心参数计算](#23-四大核心参数计算-重点)
3.  [AOV 与 AOE 的核心对比](#3-aov-与-aoe-的核心对比)

---

## 1. AOV 网 (Activity On Vertex)

### 1.1 核心定义
**AOV 网** 是指用**顶点**表示活动，用**弧（边）**表示活动间优先关系的有向图。

* **顶点 (Vertex)**：代表一个活动（如：选修课程、组装零件）。
* **边 (Edge)**：代表活动之间的**前驱/后继**关系。
    * 若存在边 $<V_i, V_j>$，则 $V_i$ 必须在 $V_j$ 开始之前完成。
* **限制**：AOV 网中**不能存在回路（环）**。如果存在环，意味着某项活动以自己为先决条件，逻辑上无法执行。

### 1.2 拓扑排序 (Topological Sort)



**定义**：将 AOV 网中所有顶点排成一个线性序列，使得网中任意前驱/后继关系在序列中依然成立。

**算法步骤 (卡恩算法 Kahn's Algorithm)**：
1.  **选点**：在有向图中选一个**入度为 0**（没有前驱）的顶点并输出。
2.  **删边**：从图中删除该顶点，以及所有以它为尾的弧（即减少它所有后继节点的入度）。
3.  **循环**：重复步骤 1 和 2，直到输出所有顶点或图中不存在入度为 0 的顶点。

> **注意**：
> * 如果最终输出的顶点数 < 图中总顶点数，说明图中**存在环**。
> * 一个 AOV 网的拓扑序列**可能不唯一**。

**时间复杂度**：$O(V + E)$，其中 $V$ 是顶点数，$E$ 是边数。

---

## 2. AOE 网 (Activity On Edge)

### 2.1 核心定义
**AOE 网** 是指用**边**表示活动，用**顶点**表示事件的有向加权图。

* **顶点 (Vertex)**：表示**事件 (Event)**。
    * 事件是一个瞬间状态，表示“某些活动已经结束，后续活动可以开始”。
* **边 (Edge)**：表示**活动 (Activity)**。
    * 边上的**权值**表示活动持续的时间。
* **源点 (Source)**：入度为 0 的点，表示整个工程的开始。
* **汇点 (Sink)**：出度为 0 的点，表示整个工程的结束。

### 2.2 关键路径 (Critical Path)



* **路径长度**：路径上所有活动持续时间之和。
* **关键路径**：从源点到汇点**路径长度最长**的路径。
* **工程工期**：关键路径的长度即为整个工程完成所需的**最短时间**。
* **关键活动**：关键路径上的活动。**任何关键活动的延迟都会导致整个工程延期。**

### 2.3 四大核心参数计算 (重点)

假设活动 $a_i$ 对应边 $<j, k>$，持续时间为 $w_{j,k}$。

#### A. 事件（顶点）的参数

1.  **事件的最早发生时间** $ve(k)$
    * 含义：从源点到顶点 $k$ 的最长路径长度。只有所有前驱活动都完成了，事件 $k$ 才能发生。
    * **计算 (从源到汇，按拓扑序递推)**：
        $$ve(source) = 0$$
        $$ve(k) = \max \{ ve(j) + w_{j,k} \}$$
        *(注：其中 $j$ 为 $k$ 的所有前驱)*

2.  **事件的最迟发生时间** $vl(j)$
    * 含义：在不推迟整个工程工期的前提下，事件 $j$ 允许发生的最晚时间。
    * **计算 (从汇到源，按逆拓扑序递推)**：
        $$vl(sink) = ve(sink)$$
        $$vl(j) = \min \{ vl(k) - w_{j,k} \}$$
        *(注：其中 $k$ 为 $j$ 的所有后继)*

#### B. 活动（边）的参数

3.  **活动的最早开始时间** $e(i)$
    * 含义：该活动的起点事件最早发生的时间。
    * **公式**：若活动 $a_i$ 为 $<j, k>$，则：
        $$e(i) = ve(j)$$

4.  **活动的最迟开始时间** $l(i)$
    * 含义：该活动的终点事件最迟发生时间 减去 活动持续时间。
    * **公式**：若活动 $a_i$ 为 $<j, k>$，则：
        $$l(i) = vl(k) - w_{j,k}$$

#### C. 关键活动的判定
* **时间余量 (Slack)**：$d(i) = l(i) - e(i)$。
* **判定**：若 $l(i) == e(i)$（即时间余量为 0），则该活动为**关键活动**。

---

## 3. AOV 与 AOE 的核心对比

| 维度 | AOV 网 (Activity On Vertex) | AOE 网 (Activity On Edge) |
| :--- | :--- | :--- |
| **顶点含义** | **活动** (Tasks) | **事件** (Events) |
| **边含义** | 活动间的**先后关系** | **活动** (持续时间/权重) |
| **是否有权** | 无权值 (通常) | 有权值 (表示时间开销) |
| **解决问题** | 解决工程的**逻辑顺序**问题 | 解决工程的**时间进度/最短工期**问题 |
| **核心算法** | 拓扑排序 (Topological Sort) | 关键路径算法 (Critical Path Method) |
| **节点关系** | 所有节点都很重要 | 只有源点和汇点是唯一的，其他事件是中间态 |
| **边的性质** | 仅表示逻辑依赖 | 表示实际工作过程 |

---

### 💡 总结
* **AOV** 就像排课表：先修了高数 I，才能修高数 II —— 关注的是**顺序**。
* **AOE** 就像造房子：砌墙要 3 天，水电要 2 天，哪条线最慢决定了什么时候交房 —— 关注的是**时间**。